
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3. Building the Confirmation Website &#8212; St. Basil Confirmation Candidate Website 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Deploying the Confirmation Website" href="deploying.html" />
    <link rel="prev" title="2. Planning the Confirmation Website" href="planning.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="building-the-confirmation-website">
<h1>3. Building the Confirmation Website<a class="headerlink" href="#building-the-confirmation-website" title="Permalink to this headline">¶</a></h1>
<p>This document details the process of getting the St. Basil Confirmation Website to work on a local system. This will
be the basis for the final production website to be deployed.</p>
<div class="section" id="the-user-app">
<h2>3.1. The user App<a class="headerlink" href="#the-user-app" title="Permalink to this headline">¶</a></h2>
<p>I decided it would take too long to test the models in <code class="docutils literal"><span class="pre">ModelExperimentation</span></code> so I started building the website to
have something real to work on. I decided to start with logging in and logging out which means I had to create the
<code class="docutils literal"><span class="pre">user</span></code> app using <code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">startapp</span> <span class="pre">user</span></code> which worked as expected. Let me try a simplified version of
Test Driven Development.</p>
<div class="section" id="getting-to-the-login-page">
<h3>3.1.1. Getting to the Login Page<a class="headerlink" href="#getting-to-the-login-page" title="Permalink to this headline">¶</a></h3>
<p><strong>Does an unauthenticated user get sent to the login page when entering the root url (/)?</strong> No. I need to do some sort
of redirect.</p>
<p>Working Toward a Solution: I read <a class="reference external" href="https://docs.djangoproject.com/en/1.11/topics/auth/default/">https://docs.djangoproject.com/en/1.11/topics/auth/default/</a> and, although I’m sure it
contains some very useful information about authentication, it is not what I’m looking for now. I will try to copy what
I did in ModelExperimentation.</p>
<p>Attempt 1: in <code class="docutils literal"><span class="pre">config.urls.py</span></code> add a url pattern as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="k">import</span> <span class="n">RedirectView</span>
<span class="o">...</span>
<span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">RedirectView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s1">&#39;login/&#39;</span><span class="p">),</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Once I got the correct syntax it worked to redirect <code class="docutils literal"><span class="pre">localhost:8000</span></code> to <code class="docutils literal"><span class="pre">localhost:8000/login/</span></code>.</p>
<p>This solution, however, does not correspond to what is in <em>Django Unleashed</em>. I will look at the authentication video
I downloaded the other night that are in <code class="docutils literal"><span class="pre">Net</span> <span class="pre">Gleanings/Video</span> <span class="pre">Downloads/Django/jeff</span> <span class="pre">n</span> <span class="pre">Tutorials</span></code> and found some things
reminiscent of what I read in the documentation above. So, let’s try it! It says to put this line into the url patterns
in <code class="docutils literal"><span class="pre">config.urls.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">url</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;django.contrib.auth.urls&#39;</span><span class="p">)),</span>
</pre></div>
</div>
<p>I had to add <code class="docutils literal"><span class="pre">include</span></code> to my <code class="docutils literal"><span class="pre">django.config.urls</span></code> import and create a setting in <code class="docutils literal"><span class="pre">settings.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">LOGIN</span> <span class="o">=</span> <span class="s1">&#39;/login/&#39;</span>
</pre></div>
</div>
<p>Which, he said is not the recommended thing to do but he didn’t say what was so I’ll leave it for now. (He said
something about using <code class="docutils literal"><span class="pre">reverse_lazy</span></code> but I may have to try that later.)</p>
<p>This did not redirect to /login/ so I added the RedirectView line back in.</p>
<p><strong>Does the url ``/login/`` result in the display of the login page?</strong> No. I got a “Page not found (404)” error. It
found no reference to <code class="docutils literal"><span class="pre">/login/</span></code> in the url patterns.</p>
<p>Working Toward a Solution: I departed from the strict, or even lenient, TDD path but this is what I had to do:</p>
<ul class="simple">
<li>add user.apps.UserConfig to the installed apps</li>
<li>add LOGIN_URL = ‘/login/’ to the base.py file</li>
<li>use the url patterns: [url(r’^$’, RedirectView.as_view(url=’login/’)), url(r’^admin/’, admin.site.urls), url(‘^’, include(‘django.contrib.auth.urls’)),]</li>
<li>in the user app folder, create a templates directory containing a registration directory containing login.html</li>
<li>created a simple login.html file in the registration directory.</li>
</ul>
<p>Next I will want to create a <code class="docutils literal"><span class="pre">base.html</span></code> file someplace to form the base of all my html documents.</p>
</div>
<div class="section" id="improving-the-templates">
<h3>3.1.2. Improving the Templates<a class="headerlink" href="#improving-the-templates" title="Permalink to this headline">¶</a></h3>
<p>Based on what is done in <em>Django Unleashed</em>, I need to create the main <code class="docutils literal"><span class="pre">base.html</span></code> file in the
<code class="docutils literal"><span class="pre">ConfirmationWebsite.templates</span></code> directory and and <code class="docutils literal"><span class="pre">base_&lt;appname&gt;.html</span></code> files in each of the
<code class="docutils literal"><span class="pre">&lt;appname&gt;.templates.&lt;appname&gt;</span></code> directories.</p>
<p>Here is <code class="docutils literal"><span class="pre">base.html</span></code> (adapted from <em>Django Unleashed</em>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>{% load staticfiles %}

&lt;! DOCTYPE html &gt;

&lt;html lang=&quot;en&quot;&gt;

    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot;&gt;
        &lt;title&gt;
            {% block title %}
                St. Basil Confirmation -
            {% endblock %}
        &lt;/title&gt;
        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge, chrome=1&quot;&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;
        &lt;!--[if IE]&gt;&lt;script
            src=&quot;http://html5shiv.googlecode.com/svn/trunk/html5.js&quot;&gt;
        &lt;/script&gt;&lt;![endif]--&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot;
              href=&quot;{% static &#39;site/normalize.css&#39; %}&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot;
              href=&quot;{% static &#39;site/skeleton.css&#39; %}&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot;
              href=&quot;{% static &#39;site/custom.css&#39; %}&quot;&gt;
        {% block head %}{% endblock %}
    &lt;/head&gt;

    &lt;body&gt;
        &lt;div class=&quot;container&quot;&gt;&lt;!-- container --&gt;
            &lt;header class=&quot;row&quot;&gt;
                &lt;div class=&quot;offset-by-two eight columns&quot;&gt;
                    &lt;h1 class=&quot;logo&quot;&gt;St. Basil Confirmation Activities&lt;/h1&gt;
                &lt;/div&gt;
            &lt;/header&gt;
            &lt;div class=&quot;status row&quot;&gt;
                &lt;div class=&quot;offset-by-eight four columns&quot;&gt;
                    &lt;ul class=&quot;inline&quot;&gt;
                        {% if user.is_authenticated %}
                            &lt;li&gt;&lt;a href=&quot;{% url &#39;dj-auth:logout&#39; %}&quot;&gt;
                                Log Out
                            &lt;/a&gt;&lt;/li&gt;
                        {% else %}
                            &lt;li&gt;&lt;a href=&quot;{% url &#39;dj-auth:login&#39; %}&quot;&gt;
                                Log In
                            &lt;/a&gt;&lt;/li&gt;
                        {% endif %}
                    &lt;/ul&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;main&gt;
                {% block content %}
                    This is default content!
                {% endblock %}
            &lt;/main&gt;
        &lt;/div&gt;&lt;!-- container --&gt;

        &lt;footer&gt;
            &lt;p class=&quot;offset-by-eight four columns&quot;&gt;
                Modified from base.html created for
                &lt;a href=&quot;https://Django-Unleashed.com/&quot;&gt;
                    Django Unleashed&lt;/a&gt;
            &lt;/p&gt;
        &lt;/footer&gt;
    &lt;/body&gt;
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">base_&lt;appname&gt;.html</span></code> files have this form:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="n">parent_template</span><span class="o">|</span><span class="n">default</span><span class="p">:</span><span class="s2">&quot;base.html&quot;</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Now the <code class="docutils literal"><span class="pre">login.html</span></code> file can say:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>{% extends &#39;user/base_user.html&#39; %}

{% block title %}Login{% endblock %}

{% block content %}
    Yay!!!
{% endblock %}
</pre></div>
</div>
</div>
<div class="section" id="logging-in">
<h3>3.1.3. Logging In<a class="headerlink" href="#logging-in" title="Permalink to this headline">¶</a></h3>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. Django throws
some goofy ProgrammingError about <code class="docutils literal"><span class="pre">&quot;auth_user&quot;</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">exist</span></code>. I need to run <code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">createsuperuser</span></code>.</p>
<p><strong>Can you create a superuser?</strong> No. It threw the same error as before but, in the command window, Django also reminded
me to perform a <code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code>. When I did that it did mention that “auth” was one of the migrations it
performed.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It just keeps
returning to the login page with no error messages. I will have to deal with that (the no error messages) later.
Otherwise I need to create some users after creating a superuser.</p>
<p><strong>Can you create a superuser?</strong> Yes. I used ‘Jim’ as my username, <a class="reference external" href="mailto:'FrJamesMorris&#37;&#52;&#48;gmail&#46;com">‘FrJamesMorris<span>&#64;</span>gmail<span>&#46;</span>com</a>’ as my e-mail and
dylan-selfie as my password.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It seems to be
accepting the username and password I created for the superuser but tries to send me to the default
<code class="docutils literal"><span class="pre">/accounts/profile/</span></code> page. I need to add a welcome page and the means of arriving there.</p>
</div>
<div class="section" id="arriving-at-the-welcome-page">
<h3>3.1.4. Arriving at the Welcome Page<a class="headerlink" href="#arriving-at-the-welcome-page" title="Permalink to this headline">¶</a></h3>
<p>What I think I need to do is:</p>
<ol class="arabic simple">
<li>Import reverse_lazy from django.core.urlresolvers</li>
<li>Add a LOGIN_REDIRECT_URL to base.py</li>
<li>Create a new ‘activities’ app that will hold the welcome page</li>
<li>Include the activities url patterns in config.urls.py</li>
<li>Create an activities_welcome.html page to display the welcome page</li>
<li>Create a view to control what gets rendered on that page</li>
</ol>
<p>I learned that number 1 was already done, but not used yet.</p>
<p>For number 2 I added LOGIN_REDIRECT_URL = reverse_lazy(‘welcome’)</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It says:
<code class="docutils literal"><span class="pre">Reverse</span> <span class="pre">for</span> <span class="pre">'welcome'</span> <span class="pre">not</span> <span class="pre">found.</span> <span class="pre">'welcome'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">valid</span> <span class="pre">view</span> <span class="pre">function</span> <span class="pre">or</span> <span class="pre">pattern</span> <span class="pre">name</span></code>. I’ll make it a valid
pattern name as in step 4 above.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. The name
‘activities’ was not defined because I have neither created it nor imported it into base.py. I will import it into
<code class="docutils literal"><span class="pre">config.urls.py</span></code> even though it doesn’t yet exist.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. I got a
<code class="docutils literal"><span class="pre">module</span> <span class="pre">not</span> <span class="pre">found</span></code> error. I will use <code class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">startapp</span> <span class="pre">activities</span></code> to create the activities app.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. <code class="docutils literal"><span class="pre">startapp</span></code>
does not create a default <code class="docutils literal"><span class="pre">urls.py</span></code> file. I will create it myself.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. Importing
<code class="docutils literal"><span class="pre">activities.urls</span></code> into <code class="docutils literal"><span class="pre">config.urls</span></code> does not seem to work. I will change the url pattern to
<code class="docutils literal"><span class="pre">url('^activity/',</span> <span class="pre">include('activity.urls'),</span> <span class="pre">name='welcome')</span></code></p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. But I’m getting
closer. It got to <code class="docutils literal"><span class="pre">activity/urls</span></code> (I changed the name of the <code class="docutils literal"><span class="pre">activities</span></code> app above to <code class="docutils literal"><span class="pre">activity</span></code>) but found an
empty file. I will put the following into it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="k">import</span> <span class="n">url</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">WelcomePage</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;welcome_page&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. <code class="docutils literal"><span class="pre">WelcomePage</span></code>
is not defined in <code class="docutils literal"><span class="pre">activity.urls.py</span></code> I will import it.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It cannot import
<code class="docutils literal"><span class="pre">WelcomePage</span></code> because that view does not exist. I will create it as a stub.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. This time it
says <code class="docutils literal"><span class="pre">'WelcomePage'</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'as_view'</span></code> I think I need to subclass Views in my WelcomePage class. Before that
I need to import it from django.views.generic.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. But it went back
to telling me <code class="docutils literal"><span class="pre">Reverse</span> <span class="pre">for</span> <span class="pre">'welcome'</span> <span class="pre">not</span> <span class="pre">found.</span> <span class="pre">'welcome'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">valid</span> <span class="pre">view</span> <span class="pre">function</span> <span class="pre">or</span> <span class="pre">pattern</span> <span class="pre">name.</span></code> It is a valid
pattern name now so it must be looking for the view to return something. I added a simple function to it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WelcomePage</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It kept telling
me <code class="docutils literal"><span class="pre">'welcome'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">valid</span> <span class="pre">view</span> <span class="pre">function</span> <span class="pre">of</span> <span class="pre">pattern</span> <span class="pre">name.</span></code> It needed a <code class="docutils literal"><span class="pre">post</span></code> method in the WelcomePage class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">WelcomePage</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. <code class="docutils literal"><span class="pre">render()</span></code>
has <code class="docutils literal"><span class="pre">1</span> <span class="pre">required</span> <span class="pre">positional</span> <span class="pre">argument:</span> <span class="pre">'template_name'</span></code>. I will add one: <code class="docutils literal"><span class="pre">template_name</span> <span class="pre">=</span> <span class="pre">'actiity/welcome.html'</span></code></p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. But now I got
<code class="docutils literal"><span class="pre">TemplateDoesNotExist</span> <span class="pre">at</span> <span class="pre">/activity/welcome/</span></code>. I will add a stub welcome.html file to <code class="docutils literal"><span class="pre">activity.templates.activity</span></code>.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. Still can’t find
the template maybe <code class="docutils literal"><span class="pre">template_name</span> <span class="pre">=</span> <span class="pre">'welcome/welcome.html'</span></code> will work.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It kept giving
me the <code class="docutils literal"><span class="pre">TemplateDoesNotExist</span></code> error. I finally realized I haven’t informed Django that the activity app exists. I will
add <code class="docutils literal"><span class="pre">'activity.apps.ActivityConfig',</span></code> to the <code class="docutils literal"><span class="pre">INSTALLED_APPS</span></code> variabe in <code class="docutils literal"><span class="pre">base.py</span></code>.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. A message in
the terminal says
<code class="docutils literal"><span class="pre">ModuleNotFoundError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'activity.apps.ActivityConfig';</span> <span class="pre">'activity.apps'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">package</span></code>. Inside the
<code class="docutils literal"><span class="pre">apps.py</span></code> file the class name was still <code class="docutils literal"><span class="pre">ActivitiesConfig</span></code> so I changed it to <code class="docutils literal"><span class="pre">ActivityConfig</span></code>.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> No. It got to a
page with the proper header and footer but it still contained the default content. I will add the {% block content %}
and {% endblock %} around the ‘Got to the Welcome page!’ stub.</p>
<p><strong>Does entering a username and password on the login page result on arriving at the Welcome page?</strong> Yes! Hurray! Now I
can do something else.</p>
</div>
<div class="section" id="adding-the-activity-list-to-the-welcome-page">
<h3>3.1.5. Adding the Activity List to the Welcome Page<a class="headerlink" href="#adding-the-activity-list-to-the-welcome-page" title="Permalink to this headline">¶</a></h3>
<p>This will Finishing the welcome page is going to require me to:</p>
<ol class="arabic simple">
<li>Update <code class="docutils literal"><span class="pre">welcome.html</span></code> to include the display of a list of activities</li>
<li>Update the <code class="docutils literal"><span class="pre">get</span></code> method in the WelcomePage view class to feed the template the right values</li>
<li>Create the Activity model, make migrations and migrate</li>
<li>Make it look nice with css</li>
</ol>
<p>I thought of a better way to document my approach to Test Driven Development. Each question can appear as the title of
a csv-table with the results and subsequent actions as the table columns.</p>
<table border="1" class="colwidths-auto docutils" id="id1">
<caption><span class="caption-text"><strong>Does a list of activities appear on the welcome page?</strong></span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Result</th>
<th class="head">Action before next test</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>No</td>
<td>Add a simple listing to the <code class="docutils literal"><span class="pre">welcome.html</span></code> file using the context variable <code class="docutils literal"><span class="pre">activities</span></code></td>
</tr>
<tr class="row-odd"><td>No</td>
<td>page displayed with no list; update the <code class="docutils literal"><span class="pre">get</span></code> method in WelcomePage view</td>
</tr>
<tr class="row-even"><td>No</td>
<td>ImportError upon writing <a class="reference internal" href="#act-import"><span class="std std-ref">import</span></a>; create the <a class="reference internal" href="#activity-model"><span class="std std-ref">model</span></a> and migrate.</td>
</tr>
<tr class="row-odd"><td>No</td>
<td>still nothing in list; <a class="reference internal" href="#send-context"><span class="std std-ref">send a context variable</span></a> from <code class="docutils literal"><span class="pre">views.WelcomePage.get</span></code>.</td>
</tr>
<tr class="row-even"><td>No</td>
<td>use admin app to add some activities</td>
</tr>
<tr class="row-odd"><td>No</td>
<td>register Activity in <code class="docutils literal"><span class="pre">activities.admin.py</span></code>: <code class="docutils literal"><span class="pre">from</span> <span class="pre">.models</span> <span class="pre">import</span> <span class="pre">Activity...</span> <span class="pre">admin.site.register(Activity)</span></code></td>
</tr>
<tr class="row-even"><td>No</td>
<td>nothing to show in list; add four activities to the Activity model</td>
</tr>
<tr class="row-odd"><td>Yes!</td>
<td>Now to make it look nice</td>
</tr>
</tbody>
</table>
<p id="act-import">The Activity model import in <code class="docutils literal"><span class="pre">activity.views.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.models</span> <span class="k">import</span> <span class="n">Activity</span>
</pre></div>
</div>
<p id="activity-model">The Activity Model:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Activity</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p id="send-context">Sending the ‘activities’ context variable from activity.views.WelcomePage.get:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="n">activities</span> <span class="o">=</span> <span class="n">Activity</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;activities&#39;</span><span class="p">:</span> <span class="n">activities</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="making-the-welcome-page-look-better">
<h3>3.1.6. Making the Welcome Page Look Better<a class="headerlink" href="#making-the-welcome-page-look-better" title="Permalink to this headline">¶</a></h3>
<p>Here I just played with the <code class="docutils literal"><span class="pre">welcome.html</span></code> and <code class="docutils literal"><span class="pre">custom.css</span></code> files until I was happy with what I have so far. I will
have to change it later when I have more information available, such as the number of pages in each activity (which I
may call ‘events’ or ‘tasks’ [ugh!] or ‘parts’ or something) to indicate how much there is to an activity. Other
information can be displayed, such as how far the user is along in each activity, which ones are completed (indicate by
color?) etc.</p>
<p>Here is the for loop in the <code class="docutils literal"><span class="pre">welcome.html</span></code> file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">activity</span> <span class="ow">in</span> <span class="n">activities</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="n">ul</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;activity-list&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">li</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;offset-by-one four columns&quot;</span><span class="o">&gt;</span>
                <span class="p">{{</span> <span class="n">activity</span><span class="o">.</span><span class="n">number</span> <span class="p">}}</span><span class="o">.</span> <span class="p">{{</span> <span class="n">activity</span> <span class="p">}}</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>Here is the new <code class="docutils literal"><span class="pre">.activity-list</span></code> selector in the <code class="docutils literal"><span class="pre">custom.css</span></code> file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">activity</span><span class="o">-</span><span class="nb">list</span> <span class="p">{</span>
    <span class="nb">list</span><span class="o">-</span><span class="n">style</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">none</span><span class="p">;</span>
    <span class="n">color</span><span class="p">:</span> <span class="c1">#2eb873;</span>
    <span class="n">font</span><span class="o">-</span><span class="n">weight</span><span class="p">:</span> <span class="n">bold</span><span class="p">;</span>
    <span class="n">margin</span><span class="o">-</span><span class="n">top</span><span class="p">:</span> <span class="mi">20</span><span class="n">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="linking-to-the-activities">
<h3>3.1.7. Linking to the Activities<a class="headerlink" href="#linking-to-the-activities" title="Permalink to this headline">¶</a></h3>
<p>The list items on the Welcome page are supposed to be links to the actual activity pages. To implement this I think I
will need to:</p>
<ol class="arabic simple">
<li>Make the activity list items into links to the first page of the corresponding activity.</li>
<li>Create the <code class="docutils literal"><span class="pre">activity.urls</span></code> pattern to pick up the slug for page 1.</li>
<li>Create a view in <code class="docutils literal"><span class="pre">activity.views</span></code> to render the page</li>
<li>Create the Page model in <code class="docutils literal"><span class="pre">activity.models</span></code></li>
<li>Create a template <code class="docutils literal"><span class="pre">instruction_page.html</span></code> for the view to render</li>
</ol>
<table border="1" class="colwidths-auto docutils" id="id2">
<caption><span class="caption-text"><strong>Does clicking on an activity bring me to the instruction page for that activity?</strong></span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Result</th>
<th class="head">Action before next test</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>No</td>
<td>Nothing at all happens. Convert the list items to links</td>
</tr>
<tr class="row-odd"><td>No</td>
<td>‘Page not found’; create a <a class="reference internal" href="#page-url"><span class="std std-ref">url pattern</span></a> in <code class="docutils literal"><span class="pre">activity.urls</span></code> and corresponding stub view</td>
</tr>
<tr class="row-even"><td>No</td>
<td>still couldn’t fine it; error in url pattern; try a <a class="reference internal" href="#new-page-url"><span class="std std-ref">new one</span></a>.</td>
</tr>
<tr class="row-odd"><td>No</td>
<td>it got to the url but there was nothing to get; fill out the <a class="reference internal" href="#page-display-01"><span class="std std-ref">PageDisplay`</span></a> view.</td>
</tr>
<tr class="row-even"><td>No</td>
<td>get() got an unexpected keyword argument ‘slug’; include <code class="docutils literal"><span class="pre">slug</span></code> <code class="docutils literal"><span class="pre">and</span> <span class="pre">page_number</span></code> in the call to <code class="docutils literal"><span class="pre">get()</span></code></td>
</tr>
<tr class="row-odd"><td>No</td>
<td>TemplateDoesNotExist; create <code class="docutils literal"><span class="pre">page_display.html</span></code> in <code class="docutils literal"><span class="pre">activity.templates.activity</span></code></td>
</tr>
<tr class="row-even"><td>No</td>
<td>the view does not use page data; modify <a class="reference internal" href="#page-display-02"><span class="std std-ref">PageDisplay</span></a> to use the (non-existent) Page model</td>
</tr>
<tr class="row-odd"><td>No</td>
<td>no Page model; create a <a class="reference internal" href="#page-model"><span class="std std-ref">Page model</span></a>; add to <code class="docutils literal"><span class="pre">admin.py</span></code>; update the <a class="reference internal" href="#page-display-03"><span class="std std-ref">template</span></a>.</td>
</tr>
<tr class="row-even"><td>Yes</td>
<td>Now I can add some questions (try to dump the database for transfer to other computers).</td>
</tr>
</tbody>
</table>
<p id="page-url">Here is the new url:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;slug&gt;[\w\-]+)/(?P&lt;page_number&gt;)/$&#39;</span><span class="p">,</span> <span class="n">PageDisplay</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;page_display&quot;</span><span class="p">),</span>
</pre></div>
</div>
<p id="new-page-url">That one didn’t work. I neglected to indicate a pattern for the &lt;page_number&gt;. Here is a better one:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;slug&gt;[\w\-]+)/(?P&lt;page_number&gt;[0-9]+)/$&#39;</span><span class="p">,</span> <span class="n">PageDisplay</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;page_display&quot;</span><span class="p">),</span>
</pre></div>
</div>
<p id="page-display-01">Here is the first try at the PageDisplay view:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PageDisplay</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;activity/page_display.html&#39;</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">)</span>
</pre></div>
</div>
<p id="page-display-02">Here is the second form of the PageDisplay view:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PageDisplay</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;activity/page_display.html&#39;</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">page_number</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="n">Page</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">activity__slug</span><span class="o">=</span><span class="n">slug</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">template_name</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;pages&#39;</span><span class="p">:</span><span class="n">pages</span><span class="p">})</span>
</pre></div>
</div>
<p id="page-model">Here is the current form of the page model. I should be able to make a combination of activity and number unique
though:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Page</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">activity</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Activity</span><span class="p">)</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Instructions&#39;</span><span class="p">),</span>
                                     <span class="p">(</span><span class="s1">&#39;MC&#39;</span><span class="p">,</span> <span class="s1">&#39;Multichoice&#39;</span><span class="p">),</span>
                                     <span class="p">(</span><span class="s1">&#39;ES&#39;</span><span class="p">,</span> <span class="s1">&#39;Essay&#39;</span><span class="p">),</span>
                                     <span class="p">(</span><span class="s1">&#39;AN&#39;</span><span class="p">,</span> <span class="s1">&#39;Anonymous&#39;</span><span class="p">)])</span>
    <span class="n">timed</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activity</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Page: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
<p id="page-display-03">Here is the version of page-display.html that lists all the available pages for an activity:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">extends</span> <span class="s1">&#39;activity/base_activity.html&#39;</span> <span class="o">%</span><span class="p">}</span>

<span class="p">{</span><span class="o">%</span> <span class="n">block</span> <span class="n">content</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;</span><span class="n">ul</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">pages</span> <span class="o">%</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="n">li</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">page</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
    <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endblock</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="things-i-learned-or-still-need-to-study">
<h2>3.2. Things I Learned or Still Need to Study<a class="headerlink" href="#things-i-learned-or-still-need-to-study" title="Permalink to this headline">¶</a></h2>
<div class="section" id="static-files">
<h3>3.2.1. Static Files<a class="headerlink" href="#static-files" title="Permalink to this headline">¶</a></h3>
<p>In order to get the <code class="docutils literal"><span class="pre">skeleton.css</span></code> files etc. to work I had to put these lines into my <code class="docutils literal"><span class="pre">base.py</span></code> program:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">STATIC_URL</span> <span class="o">=</span> <span class="s1">&#39;/static/&#39;</span>
<span class="n">STATICFILES_DIRS</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s2">&quot;static&quot;</span><span class="p">,</span> <span class="s2">&quot;site&quot;</span> <span class="p">),</span> <span class="p">)</span>
</pre></div>
</div>
<p>and the references to them had to change to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>
      <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">tatic &#39;/normalize.css&#39; %}&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>
      <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">tatic &#39;/skeleton.css&#39; %}&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>
      <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">tatic &#39;custom.css&#39; %}&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>I’m not sure why I couldn’t do it as it was done in <em>Django Unleashed</em> but whatever works is fine by me.</p>
<p><strong>I may need to study how Django handles static files.</strong></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/images/HolyspiritYellowRedFlipped.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="startup.html">1. Starting the Confirmation Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="planning.html">2. Planning the Confirmation Website</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. Building the Confirmation Website</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-user-app">3.1. The user App</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-to-the-login-page">3.1.1. Getting to the Login Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="#improving-the-templates">3.1.2. Improving the Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging-in">3.1.3. Logging In</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arriving-at-the-welcome-page">3.1.4. Arriving at the Welcome Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-the-activity-list-to-the-welcome-page">3.1.5. Adding the Activity List to the Welcome Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="#making-the-welcome-page-look-better">3.1.6. Making the Welcome Page Look Better</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linking-to-the-activities">3.1.7. Linking to the Activities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#things-i-learned-or-still-need-to-study">3.2. Things I Learned or Still Need to Study</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#static-files">3.2.1. Static Files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploying.html">4. Deploying the Confirmation Website</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="planning.html" title="previous chapter">2. Planning the Confirmation Website</a></li>
      <li>Next: <a href="deploying.html" title="next chapter">4. Deploying the Confirmation Website</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Fr. Jim Morris.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/building.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>